name: Dwell
options:
  bundleIdPrefix: com.gauntletai
  deploymentTarget:
    iOS: 16.0
packages:
  Firebase:
    url: https://github.com/firebase/firebase-ios-sdk.git
    from: 10.15.0
targets:
  Models:
    type: framework
    platform: iOS
    sources:
      - path: Sources/Models
    dependencies:
      - package: Firebase
        product: FirebaseFirestore
      - package: Firebase
        product: FirebaseFirestoreSwift
    settings:
      base:
        DEFINES_MODULE: YES
        GENERATE_INFOPLIST_FILE: YES
        SWIFT_ACTIVE_COMPILATION_CONDITIONS: GRPC_BUILD_FROM_SOURCE
        DYLIB_INSTALL_NAME_BASE: "@rpath"
        LD_RUNPATH_SEARCH_PATHS: "$(inherited) @executable_path/Frameworks @loader_path/Frameworks"
        SKIP_INSTALL: YES
        CLANG_CXX_LIBRARY: "libc++"
        CLANG_CXX_LANGUAGE_STANDARD: "c++17"
        OTHER_LDFLAGS: ["-lc++"]

  Services:
    type: framework
    platform: iOS
    sources:
      - path: Sources/Services
    dependencies:
      - target: Models
      - package: Firebase
        product: FirebaseAuth
      - package: Firebase
        product: FirebaseStorage
      - package: Firebase
        product: FirebaseFirestore
      - package: Firebase
        product: FirebaseFirestoreSwift
    settings:
      base:
        DEFINES_MODULE: YES
        GENERATE_INFOPLIST_FILE: YES
        SWIFT_ACTIVE_COMPILATION_CONDITIONS: GRPC_BUILD_FROM_SOURCE
        DYLIB_INSTALL_NAME_BASE: "@rpath"
        LD_RUNPATH_SEARCH_PATHS: "$(inherited) @executable_path/Frameworks @loader_path/Frameworks"
        SKIP_INSTALL: YES
        CLANG_CXX_LIBRARY: "libc++"
        CLANG_CXX_LANGUAGE_STANDARD: "c++17"
        OTHER_LDFLAGS: ["-lc++"]

  ViewModels:
    type: framework
    platform: iOS
    sources:
      - path: Sources/ViewModels
    dependencies:
      - target: Models
      - target: Services
    settings:
      base:
        DEFINES_MODULE: YES
        GENERATE_INFOPLIST_FILE: YES
        DYLIB_INSTALL_NAME_BASE: "@rpath"
        LD_RUNPATH_SEARCH_PATHS: "$(inherited) @executable_path/Frameworks @loader_path/Frameworks"
        SKIP_INSTALL: YES

  Views:
    type: framework
    platform: iOS
    sources:
      - path: Sources/Views
    dependencies:
      - target: Models
      - target: Services
      - target: ViewModels
      - package: Firebase
        product: FirebaseFirestore
      - package: Firebase
        product: FirebaseFirestoreSwift
    settings:
      base:
        DEFINES_MODULE: YES
        GENERATE_INFOPLIST_FILE: YES
        DYLIB_INSTALL_NAME_BASE: "@rpath"
        LD_RUNPATH_SEARCH_PATHS: "$(inherited) @executable_path/Frameworks @loader_path/Frameworks"
        SKIP_INSTALL: YES
        SWIFT_ACTIVE_COMPILATION_CONDITIONS: GRPC_BUILD_FROM_SOURCE
        CLANG_CXX_LIBRARY: "libc++"
        CLANG_CXX_LANGUAGE_STANDARD: "c++17"
        OTHER_LDFLAGS: ["-lc++"]

  Dwell:
    type: application
    platform: iOS
    sources:
      - path: Sources
        excludes:
          - "Assets.xcassets"
          - "Preview Content"
          - "Services/**"
          - "Models/**"
          - "ViewModels/**"
          - "Views/**"
      - path: Sources/Assets.xcassets
        type: folder
        buildPhase: resources
      - path: Sources/Preview Content
        type: folder
        buildPhase: resources
    dependencies:
      - target: Models
      - target: Services
      - target: ViewModels
      - target: Views
      - package: Firebase
        product: FirebaseAuth
      - package: Firebase
        product: FirebaseFirestore
      - package: Firebase
        product: FirebaseFirestoreSwift
      - package: Firebase
        product: FirebaseStorage
    settings:
      base:
        INFOPLIST_FILE: Sources/Info.plist
        PRODUCT_BUNDLE_IDENTIFIER: com.gauntletai.dwell
        ASSETCATALOG_COMPILER_APPICON_NAME: AppIcon
        DEVELOPMENT_ASSET_PATHS: Sources/Preview\ Content
        CURRENT_PROJECT_VERSION: 1
        MARKETING_VERSION: 1.0.0
        SWIFT_ACTIVE_COMPILATION_CONDITIONS: GRPC_BUILD_FROM_SOURCE
        LD_RUNPATH_SEARCH_PATHS: "$(inherited) @executable_path/Frameworks"
        CLANG_CXX_LIBRARY: "libc++"
        CLANG_CXX_LANGUAGE_STANDARD: "c++17"
        OTHER_LDFLAGS: ["-lc++"]
    info:
      path: Sources/Info.plist
      properties:
        CFBundleName: Dwell
        CFBundleDisplayName: Dwell
        CFBundlePackageType: APPL
        CFBundleShortVersionString: $(MARKETING_VERSION)
        CFBundleVersion: $(CURRENT_PROJECT_VERSION)
        UILaunchStoryboardName: LaunchScreen
        UIApplicationSceneManifest:
          UIApplicationSupportsMultipleScenes: false
          UISceneConfigurations:
            UIWindowSceneSessionRoleApplication:
              - UISceneConfigurationName: Default Configuration
                UISceneDelegateClassName: $(PRODUCT_MODULE_NAME).SceneDelegate
